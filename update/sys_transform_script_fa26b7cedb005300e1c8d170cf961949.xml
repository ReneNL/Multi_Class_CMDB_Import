<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_transform_script">
    <sys_transform_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <map display_value="Multi class CMDB import">6866c906dbc81300e1c8d170cf9619ec</map>
        <order>100</order>
        <script><![CDATA[(function runTransformScript(source, map, log, target ) {
	// This a Self-Executing Function it is only available in this context (this transform map)
	// Add your code here
	
	var gr_real_target = new GlideRecord(source.u_sys_class_name);
	// gr_real_target.addAggregate('COUNT'); Cannot be used as we really need access to the glide record
	gr_real_target.addQuery("sys_id", source.sys_target_sys_id);
	gr_real_target.query();
	
	if (gr_real_target.next()) {
		// a target record in desired CI class is available
		
		// u_sys_class_name holds the desired target CI class
		
		// for 'debugging' analyse the working stick some info in the comments field of the source record
		source.sys_import_state_comment = source.sys_import_row + ": ";
		
		// Fields for Server and sub classes
		if (source.u_host_name != "") { // when value is given process that value
			source.sys_import_state_comment = source.sys_import_state_comment + "; host_name";
			gr_real_target.host_name = source.u_host_name;
			// might give error when target CI class doesn't contain that field
		}
		
		// Fields for Printer and sub classes
		if (source.u_resolution_units != "") { // when value is given process that value
			source.sys_import_state_comment = source.sys_import_state_comment + "; resolution_units";
			gr_real_target.resolution_units = source.u_resolution_units;
			// might give error when target CI class doesn't contain that field
		}
		
		// write above modifications
		gr_real_target.update();
		source.update();
	}

})(source, map, log, target); // the  (....); means not only a declaration but also run the just declared function]]></script>
        <sys_class_name>sys_transform_script</sys_class_name>
        <sys_created_by>ADM.RWS</sys_created_by>
        <sys_created_on>2018-02-04 21:29:44</sys_created_on>
        <sys_id>fa26b7cedb005300e1c8d170cf961949</sys_id>
        <sys_mod_count>13</sys_mod_count>
        <sys_name>onAfter</sys_name>
        <sys_package display_value="Multi_Class_CMDB_Import" source="x_183176_cmdb_imp">aa924e71db441300e1c8d170cf9619af</sys_package>
        <sys_policy/>
        <sys_scope display_value="Multi_Class_CMDB_Import">aa924e71db441300e1c8d170cf9619af</sys_scope>
        <sys_update_name>sys_transform_script_fa26b7cedb005300e1c8d170cf961949</sys_update_name>
        <sys_updated_by>ADM.RWS</sys_updated_by>
        <sys_updated_on>2018-02-18 10:41:30</sys_updated_on>
        <when>onAfter</when>
    </sys_transform_script>
</record_update>
